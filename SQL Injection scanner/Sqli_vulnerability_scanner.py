import urllib.request
import urllib



def site_format(site):
    return site if site.startswith("http://") or site.startswith("https://") else "http://".join(site)




def main():
    
    site = input("Please add a website url(http://www.example.com/index.php?id=1):")
    try:
        error_msg = ["mysql_num_rows()","mysql_fetch_array()","Error Occurred While Processing Request","Server Error in '/' Application",
                                    "Microsoft OLE DB Provider for ODBC Drivers error","error in your SQL syntax","Invalid Querystring",
                                     "OLE DB Provider for ODBC","VBScript Runtime","ADODB.Field","BOF or EOF",
                                     "ADODB.Command","JET Database","mysql_fetch_row()",
                                     "Syntax error","include()","mysql_fetch_assoc()",
                                    "mysql_fetch_object()","GetArray()","FetchRow()","Input string was not in a correct format",
                                    "Microsoft VBScript","Error executing query","Error executing database query","pg_fetch_array()"]
        
        response = urllib.request.urlopen(site_format(site+"'"))
        site_content = response.read()
        result = site_content.decode('utf-8')
        print("Scanning this site, please wait...")
        numbrs_of_vulnerabilities = 0
        for err in error_msg:
            if err in result:
                numbrs_of_vulnerabilities += 1
                print("[+] " + err)
        print("[+] Numbers of vulnerabilites: "+str(numbrs_of_vulnerabilities))
    except urllib.error.HTTPError as e:
        print(e.reason)
              


if __name__ == "__main__":
    main()

                             
